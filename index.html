<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI用語集アプリ</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- 🔍 ランダム1語ページ -->
  <div id="randomWordPage" class="hidden">
    <button class="back-btn" onclick="showPage('topPage')">← ホームに戻る</button>
    <h2>ランダムで1語学ぶ</h2>
    <div id="randomWordContent">ここにランダム語が表示されます</div>
  </div>

  <!-- 🔟 今日の10語ページ -->
  <div id="todayWordsPage" class="hidden">
    <button class="back-btn" onclick="showPage('topPage')">← ホームに戻る</button>
    <h2>今日の10語</h2>
    <div id="todayWordsContent">ここに10語が表示されます</div>
  </div>

  <!-- 📝 ミニテストページ -->
  <div id="miniTestPage" class="hidden">
    <button class="back-btn" onclick="showPage('topPage')">← ホームに戻る</button>
    <h2>章ごとのミニテスト</h2>
    <div id="miniTestContent">ここにテストが表示されます</div>
  </div>

  <!-- 😖 苦手語リストページ -->
  <div id="weakWordsPage" class="hidden">
    <button class="back-btn" onclick="showPage('topPage')">← ホームに戻る</button>
    <h2>苦手語リスト</h2>
    <div id="weakWordsContent">ここに苦手語が表示されます</div>
  </div>

  <!-- 🏠 トップページ -->
  <div id="topPage" class="top-page">

    <input 
      type="text" 
      id="searchInput" 
      placeholder="用語を検索する…" 
      class="search-bar"
    />

    <div class="menu-buttons">
      <button class="menu-btn" id="btn-chapters">章一覧（用語集）</button>
      <button class="menu-btn" id="btn-random">ランダムで1語学ぶ</button>
      <button class="menu-btn" id="btn-today10">今日の10語</button>
      <button class="menu-btn" id="btn-test">章ごとのミニテスト</button>
      <button class="menu-btn" id="btn-wrong">苦手語リスト</button>
      <button class="menu-btn" style="visibility: hidden;">（空白）</button>
    </div>

  </div>

  <!-- 📚 章一覧画面 -->
  <div id="chapterList" class="hidden">
    <h2>章一覧</h2>
    <button id="btn-home" class="back-btn">ホームに戻る</button>
    <div id="chapterButtons"></div>
  </div>

  <!-- 📘 用語一覧画面 -->
  <div id="termList" class="hidden">
    <h2 id="termListTitle">用語一覧</h2>

    <button id="btn-term-home" class="back-btn">ホームに戻る</button>
    <button id="btn-back-chapters" class="back-btn">章一覧に戻る</button>

    <div id="termButtons" class="chapter-buttons"></div>
  </div>

  <!-- 📖 用語詳細画面 -->
  <div id="termDetail" class="hidden">
    <h2 id="detailTerm"></h2>

    <button id="btn-detail-home" class="back-btn">ホームに戻る</button>
    <button id="btn-detail-back" class="back-btn">用語一覧に戻る</button>

    <p><strong>読み：</strong> <span id="detailReading"></span></p>
    <p><strong>定義：</strong></p>
    <p id="detailDefinition"></p>

    <p><strong>例：</strong></p>
    <p id="detailExample"></p>
  </div>

  <!-- 🔽 JSON読み込み＋画面切り替え -->
  <script>
    /* ------------------------------
       画面切り替え関数（超重要）
    ------------------------------ */
    function showPage(pageId) {
      const pages = [
        "topPage",
        "randomWordPage",
        "todayWordsPage",
        "miniTestPage",
        "weakWordsPage",
        "chapterList",
        "termList",
        "termDetail"
      ];

      pages.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.classList.add("hidden");
      });

      document.getElementById(pageId).classList.remove("hidden");
    }

    /* ------------------------------
       JSONファイル一覧
    ------------------------------ */
    const chapterFiles = [
      "data/01_ai.json",
      "data/02_trends.json",
      "data/03_machine_learning.json",
      "data/04_deep_learning.json",
      "data/05_dl_components.json",
      "data/06_dl_applications.json",
      "data/07_ai_social_implementation.json",
      "data/08_math_statistics.json",
      "data/09_ai_law_contract.json",
      "data/10_ai_ethics_governance.json"
    ];

    /* JSONを全部読み込む */
    async function loadAllChapters() {
      const allChapters = [];
      for (const file of chapterFiles) {
        const response = await fetch(file);
        const json = await response.json();
        allChapters.push(json);
      }
      return allChapters;
    }

    /* ------------------------------
       トップページ → 各ページ
    ------------------------------ */
    document.getElementById("btn-chapters").addEventListener("click", () => showPage("chapterList"));
    document.getElementById("btn-random").addEventListener("click", () => showPage("randomWordPage"));
    document.getElementById("btn-today10").addEventListener("click", () => showPage("todayWordsPage"));
    document.getElementById("btn-test").addEventListener("click", () => showPage("miniTestPage"));
    document.getElementById("btn-wrong").addEventListener("click", () => showPage("weakWordsPage"));

    /* ------------------------------
       章一覧 → 用語一覧
    ------------------------------ */
    document.getElementById("btn-home").addEventListener("click", () => showPage("topPage"));
    document.getElementById("btn-term-home").addEventListener("click", () => showPage("topPage"));
    document.getElementById("btn-back-chapters").addEventListener("click", () => showPage("chapterList"));
    document.getElementById("btn-detail-home").addEventListener("click", () => showPage("topPage"));
    document.getElementById("btn-detail-back").addEventListener("click", () => showPage("termList"));

    /* ------------------------------
       用語一覧を表示
    ------------------------------ */
    function showTerms(chapterIndex, chapterData) {
      showPage("termList");

      document.getElementById("termListTitle").textContent =
        `第${chapterIndex + 1}章：${chapterData.chapter_title}`;

      const termButtons = document.getElementById("termButtons");
      termButtons.innerHTML = "";

      chapterData.terms.forEach((term) => {
        const btn = document.createElement("button");
        btn.className = "menu-btn";
        btn.textContent = term.term;

        btn.addEventListener("click", () => showTermDetail(term));

        termButtons.appendChild(btn);
      });
    }

    /* ------------------------------
       用語詳細を表示
    ------------------------------ */
    function showTermDetail(termData) {
      showPage("termDetail");

      document.getElementById("detailTerm").textContent = termData.term;
      document.getElementById("detailReading").textContent = termData.reading || "（なし）";
      document.getElementById("detailDefinition").textContent = termData.definition || "（定義なし）";
      document.getElementById("detailExample").textContent = termData.example || "（例文なし）";
    }

    /* ------------------------------
       章ボタン生成
    ------------------------------ */
    window.addEventListener("DOMContentLoaded", async () => {
      const chapters = await loadAllChapters();
      const chapterButtons = document.getElementById("chapterButtons");

      chapters.forEach((chapter, index) => {
        const btn = document.createElement("button");
        btn.className = "menu-btn";
        btn.textContent = `第${index + 1}章：${chapter.chapter_title}`;

        btn.addEventListener("click", () => showTerms(index, chapters[index]));

        chapterButtons.appendChild(btn);
      });
    });
  </script>

</body>
</html>
